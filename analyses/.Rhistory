col = 'blue', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Height (m)") +
guides(color = guide_legend("Fire History")))
plot_height
(plot_height <- ggplot(data = data, aes(x = Elevation, y = log(Height))) +
geom_jitter(aes(color = Fire, shape = Name), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15)) +
geom_line(data = height_f_trend, aes(x = height_f_seq, y = height_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = height_nf_trend, aes(x = height_nf_seq, y = height_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
# theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Height (m)") +
guides(color = guide_legend("Fire History")))
plot_height
?theme_few
??theme_few
data$Site
?scale_shape_manual
(plot_height <- ggplot(data = data, aes(x = Elevation, y = log(Height))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15), labels = NULL) +
geom_line(data = height_f_trend, aes(x = height_f_seq, y = height_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = height_nf_trend, aes(x = height_nf_seq, y = height_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
# theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Height (m)") +
guides(color = guide_legend("Fire History")))
plot_height
plot_height
(plot_height <- ggplot(data = data, aes(x = Elevation, y = log(Height))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = height_f_trend, aes(x = height_f_seq, y = height_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = height_nf_trend, aes(x = height_nf_seq, y = height_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
# theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Height (m)") +
guides(color = guide_legend("Fire History")))
plot_height
library(ggthemes)
install.packages('ggthemes')
(plot_height <- ggplot(data = data, aes(x = Elevation, y = log(Height))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = height_f_trend, aes(x = height_f_seq, y = height_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = height_nf_trend, aes(x = height_nf_seq, y = height_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Height (m)") +
guides(color = guide_legend("Fire History")))
library(ggthemes)
(plot_height <- ggplot(data = data, aes(x = Elevation, y = log(Height))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = height_f_trend, aes(x = height_f_seq, y = height_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = height_nf_trend, aes(x = height_nf_seq, y = height_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Height (m)") +
guides(color = guide_legend("Fire History")))
### canopy
canopy_lm <- lm(log(Canopy) ~ Elevation * Fire , data = data)
canopy_slope <- summary(emtrends(canopy_lm, ~ Elevation, var = "Elevation"))[1, 2]
canopy_intercept <- summary(emmeans(canopy_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
canopy_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
canopy_trend <- canopy_intercept + canopy_seq * canopy_slope
canopy_trend <- as.data.frame(cbind(canopy_seq, canopy_trend))
(plot_canopy <- ggplot(data = data, aes(x = Elevation, y = log(Canopy))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = canopy_trend, aes(x = canopy_seq, y = canopy_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "Canopy Spread (m)") +
guides(color = guide_legend("Fire History")))
### diam
diam_lm <- lm(log(Diam) ~ Elevation * Fire , data = data)
diam_slope <- summary(emtrends(diam_lm, ~ Elevation, var = "Elevation"))[1, 2]
diam_intercept <- summary(emmeans(diam_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
diam_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
diam_trend <- diam_intercept + diam_seq * diam_slope
diam_trend <- as.data.frame(cbind(diam_seq, diam_trend))
(plot_diam <- ggplot(data = data, aes(x = Elevation, y = log(Diam))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = diam_trend, aes(x = diam_seq, y = diam_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
scale_y_continuous(name = "DBH (cm)") +
guides(color = guide_legend("Fire History")))
### density
density_lm <- lm(mean_distance ~ Elevation * Fire , data = data)
density_slope <- summary(emtrends(density_lm, ~ Fire, var = "Elevation"))[1, 2]
density_intercept <- summary(emmeans(density_lm, ~ Fire, at = list(Elevation = 0)))[1, 2]
density_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
density_trend <- density_intercept + density_seq * density_slope
density_trend <- as.data.frame(cbind(density_seq, density_trend))
(plot_density <- ggplot(data = data, aes(x = Elevation, y = mean_distance)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = density_trend, aes(x = density_seq, y = density_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1500)) +
scale_y_continuous(name = "Distance Between Neighbors (m)", limits = c(0, 6)) +
guides(color = guide_legend("Fire History")))
(plots_allometry <- plot_canopy + plot_diam + plot_density + plot_height +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
plots_allometry
(plots_allometry <- plot_canopy + plot_diam + plot_density + plot_height +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
unloadNamespace('patchwork')
(plots_allometry <- plot_canopy + plot_diam + plot_density + plot_height +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
library(tidyverse)
library(emmeans)
library(lme4)
library(car)
library(circular)
library(multcompView)
library(ggthemes)
library(agricolae)
library(patchwork)
library(car)
install.packages('agricolae')
install.packages('patchwork')
library(patchwork)
(plots_allometry <- plot_canopy + plot_diam + plot_density + plot_height +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## foliar isotopes
### d13C
d13C_lm <- lm(d13C ~ Elevation * Fire , data = data)
d13C_slope <- summary(emtrends(d13C_lm, ~ Elevation, var = "Elevation"))[1, 2]
d13C_intercept <- summary(emmeans(d13C_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
d13C_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
d13C_trend <- d13C_intercept + d13C_seq * d13C_slope
d13C_trend <- as.data.frame(cbind(d13C_seq, d13C_trend))
(plot_d13C <- ggplot(data = data, aes(x = Elevation, y = d13C)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = d13C_trend, aes(x = d13C_seq, y = d13C_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression(delta^{"13"}*"C (‰)")) +
guides(color = guide_legend("Fire History")))
### d15N
d15N_lm <- lm(d15N ~ Elevation * Fire , data = data)
(plot_d15N <- ggplot(data = data, aes(x = Elevation, y = d15N)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression(delta^{"15"}*"N (‰)")) +
guides(color = guide_legend("Fire History")))
## foliar organics
### C_foliar
C_foliar_lm <- lm(C_foliar ~ Elevation * Fire , data = data)
(plot_C_foliar <- ggplot(data = data, aes(x = Elevation, y = C_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1500)) +
ylab(expression("Foliar Carbon (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### N_foliar
N_foliar_lm <- lm(N_foliar ~ Elevation * Fire , data = data)
(plot_N_foliar <- ggplot(data = data, aes(x = Elevation, y = N_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1500)) +
ylab(expression("Foliar Nitrogen (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### CN_foliar
CN_foliar_lm <- lm(CN_foliar ~ Elevation * Fire , data = data)
(plot_CN_foliar <- ggplot(data = data, aes(x = Elevation, y = N_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1500)) +
ylab("Foliar Carbon/Nitrogen") +
guides(color = guide_legend("Fire History")))
## foliar inorganics
### Ca_foliar
Ca_foliar_lm <- lm(Ca_foliar ~ Elevation * Fire , data = data)
Ca_foliar_slope <- summary(emtrends(Ca_foliar_lm, ~ Elevation, var = "Elevation"))[1, 2]
Ca_foliar_intercept <- summary(emmeans(Ca_foliar_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
Ca_foliar_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
Ca_foliar_trend <- Ca_foliar_intercept + Ca_foliar_seq * Ca_foliar_slope
Ca_foliar_trend <- as.data.frame(cbind(Ca_foliar_seq, Ca_foliar_trend))
(plot_Ca_foliar <- ggplot(data = data, aes(x = Elevation, y = Ca_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = Ca_foliar_trend, aes(x = Ca_foliar_seq, y = Ca_foliar_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Foliar Calcium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### P_foliar
P_foliar_lm <- lm(log(P_foliar) ~ Elevation * Fire , data = data)
(plot_P_foliar <- ggplot(data = data, aes(x = Elevation, y = P_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Foliar Phosphorus (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### K_foliar
K_foliar_lm <- lm(log(K_foliar) ~ Elevation * Fire , data = data)
(plot_K_foliar <- ggplot(data = data, aes(x = Elevation, y = log(K_foliar))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
# geom_line(data = K_foliar_f_trend, aes(x = K_foliar_f_seq, y = K_foliar_f_trend),
#           col = 'red', lwd = 2, alpha = 0.8) +
# geom_line(data = K_foliar_nf_trend, aes(x = K_foliar_nf_seq, y = K_foliar_nf_trend),
#           col = 'blue', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Foliar Potassium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### Mg_foliar
Mg_foliar_lm <- lm(Mg_foliar ~ Elevation * Fire , data = data)
#plot(resid(Mg_foliar_lm) ~ fitted(Mg_foliar_lm))
Anova(Mg_foliar_lm)
(plot_Mg_foliar <- ggplot(data = data, aes(x = Elevation, y = Mg_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Foliar Magnesium (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### Al_foliar
Al_foliar_lm <- lm(Al_foliar ~ Elevation * Fire , data = data)
#plot(resid(Al_foliar_lm) ~ fitted(Al_foliar_lm))
Anova(Al_foliar_lm)
(plot_Al_foliar <- ggplot(data = data, aes(x = Elevation, y = Al_foliar)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Foliar Aluminum (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### Zn_foliar
Zn_foliar_lm <- lm(log(Zn_foliar) ~ Elevation * Fire , data = data)
#plot(resid(Zn_foliar_lm) ~ fitted(Zn_foliar_lm))
Anova(Zn_foliar_lm)
Zn_foliar_slope <- summary(emtrends(Zn_foliar_lm, ~ Elevation, var = "Elevation"))[1, 2]
Zn_foliar_intercept <- summary(emmeans(Zn_foliar_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
Zn_foliar_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
Zn_foliar_trend <- Zn_foliar_intercept + Zn_foliar_seq * Zn_foliar_slope
Zn_foliar_trend <- as.data.frame(cbind(Zn_foliar_seq, Zn_foliar_trend))
(plot_Zn_foliar <- ggplot(data = data, aes(x = Elevation, y = log(Zn_foliar))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = Zn_foliar_trend, aes(x = Zn_foliar_seq, y = Zn_foliar_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Foliar Zinc (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
(plots_foliar_organic <- (plot_d13C + plot_d15N) / (plot_C_foliar + plot_N_foliar + plot_CN_foliar) +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
(plots_foliar_inorganic <- plot_Al_foliar + plot_Ca_foliar + plot_K_foliar + plot_Mg_foliar +
plot_P_foliar + plot_Zn_foliar +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## soil organics
### C_soil
C_soil_lm <- lm(C_soil ~ Elevation * Fire , data = data)
C_soil_slope <- summary(emtrends(C_soil_lm, ~ Elevation, var = "Elevation"))[1, 2]
C_soil_intercept <- summary(emmeans(C_soil_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
C_soil_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
C_soil_trend <- C_soil_intercept + C_soil_seq * C_soil_slope
C_soil_trend <- as.data.frame(cbind(C_soil_seq, C_soil_trend))
(plot_C_soil <- ggplot(data = data, aes(x = Elevation, y = C_soil)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = C_soil_trend, aes(x = C_soil_seq, y = C_soil_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Carbon (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### N_soil
N_soil_lm <- lm(N_soil ~ Elevation * Fire , data = data)
(plot_N_soil <- ggplot(data = data, aes(x = Elevation, y = N_soil)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Nitrogen (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### CN_soil
CN_soil_lm <- lm(log(CN_soil) ~ Elevation * Fire , data = data)
(plot_CN_soil <- ggplot(data = data, aes(x = Elevation, y = log(CN_soil))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
# geom_line(data = CN_soil_trend, aes(x = CN_soil_seq, y = CN_soil_trend),
#           col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab("Soil Carbon/Nitrogen") +
guides(color = guide_legend("Fire History")))
## soil inorganics
### Ca_soil
Ca_soil_lm <- lm(Ca_soil ~ Elevation * Fire , data = data)
Ca_soil_slope <- summary(emtrends(Ca_soil_lm, ~ Elevation, var = "Elevation"))[1, 2]
Ca_soil_intercept <- summary(emmeans(Ca_soil_lm, ~ Elevation, at = list(Elevation = 0)))[1, 2]
Ca_soil_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
Ca_soil_trend <- Ca_soil_intercept + Ca_soil_seq * Ca_soil_slope
Ca_soil_trend <- as.data.frame(cbind(Ca_soil_seq, Ca_soil_trend))
(plot_Ca_soil <- ggplot(data = data, aes(x = Elevation, y = Ca_soil)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = Ca_soil_trend, aes(x = Ca_soil_seq, y = Ca_soil_trend),
col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Calcium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### P_soil
P_soil_lm <- lm(log(P_soil) ~ Elevation * Fire , data = data)
(plot_P_soil <- ggplot(data = data, aes(x = Elevation, y = log(P_soil))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
# geom_line(data = P_soil_trend, aes(x = P_soil_seq, y = P_soil_trend),
#           col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Phosphorus (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### K_soil
K_soil_lm <- lm(K_soil ~ Elevation * Fire , data = data)
(plot_K_soil <- ggplot(data = data, aes(x = Elevation, y = K_soil)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
# geom_line(data = K_soil_trend, aes(x = K_soil_seq, y = K_soil_trend),
#           col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Potassium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### Mg_soil
Mg_soil_lm <- lm(Mg_soil ~ Elevation * Fire , data = data)
(plot_Mg_soil <- ggplot(data = data, aes(x = Elevation, y = Mg_soil)) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
# geom_line(data = Mg_soil_trend, aes(x = Mg_soil_seq, y = Mg_soil_trend),
#           col = 'black', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Magnesium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### Al_soil
Al_soil_lm <- lm(log(Al_soil) ~ Elevation * Fire , data = data)
Al_soil_f_slope <- summary(emtrends(Al_soil_lm, ~ Fire, var = "Elevation"))[1, 2]
Al_soil_f_intercept <- summary(emmeans(Al_soil_lm, ~ Fire, at = list(Elevation = 0)))[1, 2]
Al_soil_f_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
Al_soil_f_trend <- Al_soil_f_intercept + Al_soil_f_seq * Al_soil_f_slope
Al_soil_f_trend <- as.data.frame(cbind(Al_soil_f_seq, Al_soil_f_trend))
Al_soil_nf_slope <- summary(emtrends(Al_soil_lm, ~ Fire, var = "Elevation"))[2, 2]
Al_soil_nf_intercept <- summary(emmeans(Al_soil_lm, ~ Fire, at = list(Elevation = 0)))[2, 2]
Al_soil_nf_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
Al_soil_nf_trend <- Al_soil_nf_intercept + Al_soil_nf_seq * Al_soil_nf_slope
Al_soil_nf_trend <- as.data.frame(cbind(Al_soil_nf_seq, Al_soil_nf_trend))
(plot_Al_soil <- ggplot(data = data, aes(x = Elevation, y = log(Al_soil))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = Al_soil_f_trend, aes(x = Al_soil_f_seq, y = Al_soil_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = Al_soil_nf_trend, aes(x = Al_soil_nf_seq, y = Al_soil_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Aluminum (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### Zn_soil
Zn_soil_lm <- lm(log(Zn_soil) ~ Elevation * Fire , data = data)
(plot_Zn_soil <- ggplot(data = data, aes(x = Elevation, y = log(Zn_soil))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab(expression("Soil Zinc (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")))
### retention
retention_lm <- lm(asin(sqrt(0.01 * Retention)) ~ Elevation * Fire , data = data)
retention_f_slope <- summary(emtrends(retention_lm, ~ Fire, var = "Elevation"))[1, 2]
retention_f_intercept <- summary(emmeans(retention_lm, ~ Fire, at = list(Elevation = 0)))[1, 2]
retention_f_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
retention_f_trend <- retention_f_intercept + retention_f_seq * retention_f_slope
retention_f_trend <- as.data.frame(cbind(retention_f_seq, retention_f_trend))
retention_nf_slope <- summary(emtrends(retention_lm, ~ Fire, var = "Elevation"))[2, 2]
retention_nf_intercept <- summary(emmeans(retention_lm, ~ Fire, at = list(Elevation = 0)))[2, 2]
retention_nf_seq <- seq(min(data$Elevation, na.rm = T), max(data$Elevation, na.rm = T), 0.01)
retention_nf_trend <- retention_nf_intercept + retention_nf_seq * retention_nf_slope
retention_nf_trend <- as.data.frame(cbind(retention_nf_seq, retention_nf_trend))
(plot_retention <- ggplot(data = data, aes(x = Elevation, y = asin(sqrt(0.01 * Retention)))) +
geom_jitter(aes(color = Fire, shape = Site), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
scale_shape_manual(values = c(16, 17, 18, 15),
labels = c('GOR', 'SCT', 'WON', 'STS')) +
geom_line(data = retention_f_trend, aes(x = retention_f_seq, y = retention_f_trend),
col = 'red', lwd = 2, alpha = 0.8) +
geom_line(data = retention_nf_trend, aes(x = retention_nf_seq, y = retention_nf_trend),
col = 'blue', lwd = 2, alpha = 0.8) +
theme_few(base_size = 16) +
scale_x_continuous(name = "Elevation (m)", limits = c(0, 1000)) +
ylab("Soil Water Retention (%)") +
guides(color = guide_legend("Fire History")))
(plots_soil_organics <- plot_C_soil + plot_N_soil + plot_CN_soil + plot_retention +
plot_layout(guides = "collect") +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
(plots_soil_inorganics <- plot_Al_soil + plot_Ca_soil + plot_K_soil + plot_Mg_soil + plot_P_soil + plot_Zn_soil +
plot_layout(guides = "collect") +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## allometry
ggsave("plots/plots_allometry.jpeg", plot = plots_allometry,
width = 28, height = 18, units = "cm", dpi = 600) # 4 panels
## foliar nutrients
ggsave("plots/plots_foliar_organics.jpeg", plot = plots_foliar_organic,
width = 45, height = 25, units = "cm", dpi = 600) # 5 panels
ggsave("plots/plots_foliar_inorganics.jpeg", plot = plots_foliar_inorganic,
width = 45, height = 25, units = "cm", dpi = 600) # 6 panels
## soil nutrients
ggsave("plots/plots_soil_organics.jpeg", plot = plots_soil_organics,
width = 42, height = 25, units = "cm", dpi = 600) # 4 panels
ggsave("plots/plots_soil_inorganics.jpeg", plot = plots_soil_inorganics,
width = 42, height = 25, units = "cm", dpi = 600) # 6 panels
